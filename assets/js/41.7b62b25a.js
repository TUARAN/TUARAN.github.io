(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{544:function(e,t,s){"use strict";s.r(t);var n=s(2),r=Object(n.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),s("p",[e._v("源码阅读可能会迟到，但是一定不会缺席！")]),e._v(" "),s("p",[e._v("众所周知，以下代码就是 vue 的一种直接上手方式。通过 cdn 可以在线打开 vue.js。一个文件，一万行源码，能让万千开发者赖以生存，它究竟做了什么？让人品味。")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("<html>\n<head></head>\n<body>\n    <div id=\"app\">\n        {{ message }}\n    </div>\n</body>\n<script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"><\/script>\n<script>\n    var app = new Vue({\n        el: '#app',\n        data: {\n            message: 'See Vue again!'\n        },\n    })\n<\/script>\n</html>\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br")])]),s("p",[e._v("源码cdn地址："),s("a",{attrs:{href:"https://cdn.jsdelivr.net/npm/vue/dist/vue.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://cdn.jsdelivr.net/npm/vue/dist/vue.js"),s("OutboundLink")],1),e._v("，当下版本：v2.6.11")]),e._v(" "),s("p",[e._v("选择生啃的原因是，自认为已经有一定的基础，且可以更自主地选择代码段分轻重来阅读，一方面测试自己的掌握程度，一方面追求更直观的源码阅读。")]),e._v(" "),s("p",[e._v("当然你也可以选择在 "),s("a",{attrs:{href:"https://github.com/vuejs/vue/tree/dev/src",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/vuejs/vue/tree/dev/src"),s("OutboundLink")],1),e._v(" 分模块的阅读，也可以看各路大神的归类整理。")]),e._v(" "),s("p",[e._v("笔者尽量按 500 行作为一个模块来形成一个 md 文件，结合注释、自己的理解、以及附上对应查询链接来逐行细读源码。")]),e._v(" "),s("p",[e._v("目的：自我梳理，分享交流。")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc1.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（1/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc2.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（2/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc3.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（3/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc4.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（4/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc5.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（5/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc6.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（6/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc7.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（7/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc8.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（8/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc9.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（9/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc10.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（10/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc11.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（11/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc12.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（12/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc13.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（13/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc14.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（14/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc15.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（15/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc16.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（16/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc17.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（17/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc18.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（18/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc19.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（19/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（20/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（21/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（22/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（23/24）"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（24/24）"),s("OutboundLink")],1)])]),e._v(" "),s("h2",{attrs:{id:"正文"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#正文"}},[e._v("#")]),e._v(" 正文")]),e._v(" "),s("h3",{attrs:{id:"第-356-行-至-第-612-行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第-356-行-至-第-612-行"}},[e._v("#")]),e._v(" 第 356 行 至 第 612 行")]),e._v(" "),s("p",[e._v("// 定义常量和配置")]),e._v(" "),s("ul",[s("li",[e._v("SSR_ATTR// 服务端渲染")]),e._v(" "),s("li",[e._v("ASSET_TYPES// 全局函数 component、directive、filter")]),e._v(" "),s("li",[e._v("LIFECYCLE_HOOKS// 生命周期，无需多言")]),e._v(" "),s("li",[e._v("config // 全局配置 "),s("a",{attrs:{href:"https://www.cnblogs.com/greatdesert/p/11011015.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("link"),s("OutboundLink")],1)]),e._v(" "),s("li",[e._v("unicodeRegExp//用于解析html标记、组件名称和属性pat的unicode字母")]),e._v(" "),s("li",[e._v("isReserved//  检查变量的开头是 $ 或 _")]),e._v(" "),s("li",[e._v("def// 在一个对象上定义一个属性的构造函数，其中 !!enumerable 强制转换 boolean")]),e._v(" "),s("li",[e._v("parsePath// 解析一个简单路径 TODO:")]),e._v(" "),s("li",[e._v("userAgent// 浏览器识别")]),e._v(" "),s("li",[e._v("inBrowser")]),e._v(" "),s("li",[e._v("_isServer//检测 vue的服务器渲染是否存在, 而且避免webpack去填充process")]),e._v(" "),s("li",[e._v("isNative //这里判断 函数是否是系统函数, 比如 Function Object ExpReg window document 等等, 这些函数应该使用c/c++实现的。这样可以区分 Symbol是系统函数, 还是用户自定义了一个Symbol")]),e._v(" "),s("li",[e._v("hasSymbol//这里使用了ES6的Reflect方法, 使用这个对象的目的是, 为了保证访问的是系统的原型方法, ownKeys 保证key的输出顺序, 先数组 后字符串")]),e._v(" "),s("li",[e._v("_Set// 设置一个Set")])]),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.cnblogs.com/dhsz/p/7064913.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("link"),s("OutboundLink")],1)]),e._v(" "),s("h3",{attrs:{id:"第-616-行至第-706-行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第-616-行至第-706-行"}},[e._v("#")]),e._v(" 第 616 行至第 706 行")]),e._v(" "),s("p",[e._v("//设置warn,tip等全局变量 TODO:")]),e._v(" "),s("ul",[s("li",[e._v("warn")]),e._v(" "),s("li",[e._v("tip")]),e._v(" "),s("li",[e._v("generateComponentTrace// 生成组件跟踪路径（组件数规则）")]),e._v(" "),s("li",[e._v("formatComponentName// 格式化组件名")])]),e._v(" "),s("h3",{attrs:{id:"第-710-行至第-763-行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第-710-行至第-763-行"}},[e._v("#")]),e._v(" 第 710 行至第 763 行")]),e._v(" "),s("p",[s("strong",[e._v("Vue核心：数据监听最重要之一的 Dep")])]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("// Dep是订阅者Watcher对应的数据依赖\nvar Dep = function Dep () {\n  //每个Dep都有唯一的ID\n  this.id = uid++;\n  //subs用于存放依赖\n  this.subs = [];\n};\n\n//向subs数组添加依赖\nDep.prototype.addSub = function addSub (sub) {\n  this.subs.push(sub);\n};\n//移除依赖\nDep.prototype.removeSub = function removeSub (sub) {\n  remove(this.subs, sub);\n};\n//设置某个Watcher的依赖\n//这里添加了Dep.target是否存在的判断，目的是判断是不是Watcher的构造函数调用\n//也就是说判断他是Watcher的this.get调用的，而不是普通调用\nDep.prototype.depend = function depend () {\n  if (Dep.target) {\n    Dep.target.addDep(this);\n  }\n};\n\nDep.prototype.notify = function notify () {\n  var subs = this.subs.slice();\n  //通知所有绑定 Watcher。调用watcher的update()\n  for (var i = 0, l = subs.length; i &lt; l; i++) {\n    subs[i].update();\n  }\n};\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br"),s("span",{staticClass:"line-number"},[e._v("31")]),s("br"),s("span",{staticClass:"line-number"},[e._v("32")]),s("br")])]),s("p",[e._v("强烈推荐阅读："),s("a",{attrs:{href:"https://www.cnblogs.com/datiangou/p/10144883.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("link"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("Dep 相当于把 Observe 监听到的信号做一个收集（collect dependencies），然后通过dep.notify()再通知到对应 Watcher ，从而进行视图更新。")]),e._v(" "),s("h3",{attrs:{id:"第-767-行至第-900-行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第-767-行至第-900-行"}},[e._v("#")]),e._v(" 第 767 行至第 900 行")]),e._v(" "),s("p",[s("strong",[e._v("Vue核心：视图更新最重要的 VNode（ Virtual DOM）")])]),e._v(" "),s("ul",[s("li",[e._v("VNode")]),e._v(" "),s("li",[e._v("createEmptyVNode")]),e._v(" "),s("li",[e._v("createTextVNode")]),e._v(" "),s("li",[e._v("cloneVNode")])]),e._v(" "),s("p",[e._v("把你的 template 模板 描述成 VNode，然后一系列操作之后通过 VNode 形成真实DOM进行挂载")]),e._v(" "),s("p",[e._v("更新的时候对比旧的VNode和新的VNode，只更新有变化的那一部分，提高视图更新速度。")]),e._v(" "),s("p",[e._v("e.g.")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('<div class="parent" style="height:0" href="2222">\n    111111\n</div>\n\n//转成Vnode\n{    \n\n    tag: \'div\',    \n\n    data: {        \n\n        attrs:{href:"2222"}\n\n        staticClass: "parent",        \n\n        staticStyle: {            \n\n            height: "0"\n\n        }\n    },    \n\n    children: [{        \n\n        tag: undefined,        \n\n        text: "111111"\n\n    }]\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br"),s("span",{staticClass:"line-number"},[e._v("30")]),s("br")])]),s("p",[e._v("强烈推荐阅读："),s("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1479295",target:"_blank",rel:"noopener noreferrer"}},[e._v("link"),s("OutboundLink")],1)]),e._v(" "),s("ul",[s("li",[e._v("methodsToPatch")])]),e._v(" "),s("p",[e._v("将数组的基本操作方法拓展，实现响应式，视图更新。")]),e._v(" "),s("p",[e._v("因为：对于对象的修改是可以直接触发响应式的，但是对数组直接赋值，是无法触发的，但是用到这里经过改造的方法。我们可以明显的看到 ob.dep.notify() 这一核心。")]),e._v(" "),s("h3",{attrs:{id:"阶段小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#阶段小结"}},[e._v("#")]),e._v(" 阶段小结")]),e._v(" "),s("p",[e._v("这一 part 最重要的，毋庸置疑是：Dep 和 VNode，需重点突破！！！")])])}),[],!1,null,null,null);t.default=r.exports}}]);