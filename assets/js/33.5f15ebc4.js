(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{528:function(e,t,r){"use strict";r.r(t);var n=r(2),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h2",{attrs:{id:"前言"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),r("p",[e._v("源码阅读可能会迟到，但是一定不会缺席！")]),e._v(" "),r("p",[e._v("众所周知，以下代码就是 vue 的一种直接上手方式。通过 cdn 可以在线打开 vue.js。一个文件，一万行源码，能让万千开发者赖以生存，它究竟做了什么？让人品味。")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("<html>\n<head></head>\n<body>\n    <div id=\"app\">\n        {{ message }}\n    </div>\n</body>\n<script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"><\/script>\n<script>\n    var app = new Vue({\n        el: '#app',\n        data: {\n            message: 'See Vue again!'\n        },\n    })\n<\/script>\n</html>\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br"),r("span",{staticClass:"line-number"},[e._v("8")]),r("br"),r("span",{staticClass:"line-number"},[e._v("9")]),r("br"),r("span",{staticClass:"line-number"},[e._v("10")]),r("br"),r("span",{staticClass:"line-number"},[e._v("11")]),r("br"),r("span",{staticClass:"line-number"},[e._v("12")]),r("br"),r("span",{staticClass:"line-number"},[e._v("13")]),r("br"),r("span",{staticClass:"line-number"},[e._v("14")]),r("br"),r("span",{staticClass:"line-number"},[e._v("15")]),r("br"),r("span",{staticClass:"line-number"},[e._v("16")]),r("br"),r("span",{staticClass:"line-number"},[e._v("17")]),r("br")])]),r("p",[e._v("源码cdn地址："),r("a",{attrs:{href:"https://cdn.jsdelivr.net/npm/vue/dist/vue.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://cdn.jsdelivr.net/npm/vue/dist/vue.js"),r("OutboundLink")],1),e._v("，当下版本：v2.6.11")]),e._v(" "),r("p",[e._v("选择生啃的原因是，自认为已经有一定的基础，且可以更自主地选择代码段分轻重来阅读，一方面测试自己的掌握程度，一方面追求更直观的源码阅读。")]),e._v(" "),r("p",[e._v("当然你也可以选择在 "),r("a",{attrs:{href:"https://github.com/vuejs/vue/tree/dev/src",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://github.com/vuejs/vue/tree/dev/src"),r("OutboundLink")],1),e._v(" 分模块的阅读，也可以看各路大神的归类整理。")]),e._v(" "),r("p",[e._v("笔者尽量按 500 行作为一个模块来形成一个 md 文件，结合注释、自己的理解、以及附上对应查询链接来逐行细读源码。")]),e._v(" "),r("p",[e._v("目的：自我梳理，分享交流。")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc1.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（1/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc2.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（2/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc3.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（3/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc4.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（4/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc5.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（5/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc6.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（6/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc7.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（7/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc8.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（8/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc9.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（9/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc10.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（10/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc11.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（11/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc12.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（12/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc13.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（13/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc14.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（14/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc15.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（15/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc16.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（16/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc17.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（17/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc18.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（18/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc19.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（19/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（20/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（21/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（22/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（23/24）"),r("OutboundLink")],1)]),e._v(" "),r("li",[r("a",{attrs:{href:"https://tuaran.github.io/views/2020/studyVuesc20.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue.js v2.6.11 生啃一万行源码（24/24）"),r("OutboundLink")],1)])]),e._v(" "),r("h2",{attrs:{id:"正文"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#正文"}},[e._v("#")]),e._v(" 正文")]),e._v(" "),r("h3",{attrs:{id:"第-5452-行至第-5655-行"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第-5452-行至第-5655-行"}},[e._v("#")]),e._v(" 第 5452 行至第 5655 行")]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// these are reserved for web because they are directly compiled away\n// during template compilation\n\n// 这些是为web保留的，因为它们是直接编译掉的\n// 在模板编译期间\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br")])]),r("ul",[r("li",[e._v("isBooleanAttr")]),e._v(" "),r("li",[e._v("genClassForVnode// class 转码获取vonde 中的staticClass 静态class  和class动态class转义成真实dom需要的class格式。然后返回class字符串")]),e._v(" "),r("li",[e._v("mergeClassData// mergeClassData")]),e._v(" "),r("li",[e._v("renderClass// 渲染calss 这里获取到已经转码的calss")]),e._v(" "),r("li",[e._v("stringifyClass// 转码 class，把数组格式，对象格式的calss 全部转化成 字符串格式")]),e._v(" "),r("li",[e._v("stringifyArray// 数组字符串变成字符串，然后用空格 隔开 拼接 起来变成字符串")]),e._v(" "),r("li",[e._v("stringifyObject// 对象字符串变成字符串，然后用空格 隔开 拼接 起来变成字符串")]),e._v(" "),r("li",[e._v("namespaceMap")]),e._v(" "),r("li",[e._v("isHTMLTag")]),e._v(" "),r("li",[e._v("isSVG// 判断svg 标签")]),e._v(" "),r("li",[e._v("isUnknownElement// 检查dom 节点的tag标签 类型 是否是VPre 标签 或者是判断是否是浏览器自带原有的标签")]),e._v(" "),r("li",[e._v("isTextInputType //  //匹配'text,number,password,search,email,tel,url'")])]),e._v(" "),r("p",[e._v("这一 part 没有特别要说的，主要是对 class 的转码、合并和其他二次封装的工具函数。实际上我们在 Vue 源码很多地方看到了这样的封装，在平常的开发中，我们也得要求自己封装基本的函数。如果能形成自己习惯用的函数的库，会方便很多，且对自己能力也是一个提升。")]),e._v(" "),r("h3",{attrs:{id:"第-5659-行至第-5792-行"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第-5659-行至第-5792-行"}},[e._v("#")]),e._v(" 第 5659 行至第 5792 行")]),e._v(" "),r("ul",[r("li",[e._v("createElement // 创建元素，实例化 VNode")]),e._v(" "),r("li",[e._v("createElementNS")]),e._v(" "),r("li",[e._v("createTextNode")]),e._v(" "),r("li",[e._v("createComment")]),e._v(" "),r("li",[e._v("insertBefore")]),e._v(" "),r("li",[e._v("removeChild")]),e._v(" "),r("li",[e._v("appendChild")]),e._v(" "),r("li",[e._v("parentNode")]),e._v(" "),r("li",[e._v("nextSibling")]),e._v(" "),r("li",[e._v("tagName")]),e._v(" "),r("li",[e._v("setTextContent")]),e._v(" "),r("li",[e._v("setStyleScope")]),e._v(" "),r("li",[e._v("nodeOps")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("// nodeOps:\n    createElement: createElement$1, //创建一个真实的dom\n    createElementNS: createElementNS, //创建一个真实的dom svg方式\n    createTextNode: createTextNode, // 创建文本节点\n    createComment: createComment,  // 创建一个注释节点\n    insertBefore: insertBefore,  //插入节点 在xxx  dom 前面插入一个节点\n    removeChild: removeChild,   //删除子节点\n    appendChild: appendChild,  //添加子节点 尾部\n    parentNode: parentNode,  //获取父亲子节点dom\n    nextSibling: nextSibling,     //获取下一个兄弟节点\n    tagName: tagName,   //获取dom标签名称\n    setTextContent: setTextContent, //  //设置dom 文本\n    setStyleScope: setStyleScope  //设置组建样式的作用域\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br"),r("span",{staticClass:"line-number"},[e._v("8")]),r("br"),r("span",{staticClass:"line-number"},[e._v("9")]),r("br"),r("span",{staticClass:"line-number"},[e._v("10")]),r("br"),r("span",{staticClass:"line-number"},[e._v("11")]),r("br"),r("span",{staticClass:"line-number"},[e._v("12")]),r("br"),r("span",{staticClass:"line-number"},[e._v("13")]),r("br")])]),r("ul",[r("li",[e._v("ref")]),e._v(" "),r("li",[e._v("registerRef\n// 注册ref或者删除ref。比如标签上面设置了ref='abc' 那么该函数就是为this.$refs.abc 注册ref 把真实的dom存进去")])]),e._v(" "),r("h3",{attrs:{id:"阶段小结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#阶段小结"}},[e._v("#")]),e._v(" 阶段小结")]),e._v(" "),r("p",[e._v("这里的重点想必就是 “ref” 了")]),e._v(" "),r("p",[e._v("在绝大多数情况下，我们最好不要触达另一个组件实例内部或手动操作 DOM 元素。不过也确实在一些情况下做这些事情是合适的。ref 为我们提供了解决途径。")]),e._v(" "),r("p",[e._v("ref属性不是一个标准的HTML属性，只是Vue中的一个属性。")]),e._v(" "),r("h3",{attrs:{id:"第-5794-行至第-6006-行"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#第-5794-行至第-6006-行"}},[e._v("#")]),e._v(" 第 5794 行至第 6006 行")]),e._v(" "),r("p",[e._v("Virtual DOM !")]),e._v(" "),r("p",[e._v("没错，这里就是 虚拟 dom 生成的源码相关。")]),e._v(" "),r("ul",[r("li",[e._v("sameVnode")]),e._v(" "),r("li",[e._v("sameInputType")]),e._v(" "),r("li",[e._v("createKeyToOldIdx")]),e._v(" "),r("li",[e._v("createPatchFunction // !important:patch 把 vonde 渲染成真实的 dom")]),e._v(" "),r("li",[e._v("emptyNodeAt")]),e._v(" "),r("li",[e._v("createRmCb")]),e._v(" "),r("li",[e._v("removeNode")]),e._v(" "),r("li",[e._v("isUnknownElement$$1")]),e._v(" "),r("li",[e._v("createElm // 创造 dom 节点")]),e._v(" "),r("li",[e._v("createComponent // 创建组件，并且判断它是否实例化过")]),e._v(" "),r("li",[e._v("initComponent")])]),e._v(" "),r("blockquote",[r("p",[e._v("createElement方法接收一个tag参数，在内部会去判断tag标签的类型，从而去决定是创建一个普通的VNode还是一个组件类VNode；")])]),e._v(" "),r("p",[e._v("createComponent 的实现，在渲染一个组件的时候的 3 个关键逻辑：")]),e._v(" "),r("ol",[r("li",[e._v("构造子类构造函数，")]),e._v(" "),r("li",[e._v("安装组件钩子函数")]),e._v(" "),r("li",[e._v("实例化 vnode。createComponent 后返回的是组件 vnode，它也一样走到 vm._update 方法")])]),e._v(" "),r("p",[e._v("我们传入的 vnode 是组件渲染的 vnode，也就是我们之前说的 vm._vnode，如果组件的根节点是个普通元素，那么 vm._vnode 也是普通的 vnode，这里 createComponent(vnode, insertedVnodeQueue, parentElm, refElm) 的返回值是 false。接下来的过程就系列一的步骤一样了，先创建一个父节点占位符，然后再遍历所有子 VNode 递归调用 createElm，在遍历的过程中，如果遇到子 VNode 是一个组件的 VNode，则重复过程，这样通过一个递归的方式就可以完整地构建了整个组件树。")]),e._v(" "),r("blockquote",[r("p",[e._v("initComponent 初始化组建，如果没有tag标签则去更新真实dom的属性，如果有tag标签，则注册或者删除ref 然后为insertedVnodeQueue.push(vnode);")])]),e._v(" "),r("p",[r("a",{attrs:{href:"https://www.cnblogs.com/hao123456/p/10616356.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("参考link"),r("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=s.exports}}]);